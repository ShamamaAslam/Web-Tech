<%- include("../layouts/main", { title: title || "Orders" , pageCss: "admin.css" , body: ` <div class="admin-wrap">
  <div class="admin-head">
    <h1>Orders</h1>
    <div class="admin-nav">
      <a class="pill" href="/admin">Dashboard</a>
      <a class="pill active" href="/admin/orders">Orders</a>
      <a class="pill" href="/admin/appointments">Appointments</a>
      <a class="pill" href="/admin/messages">Messages</a>
      <a class="pill ghost" href="/purchase">Back</a>
    </div>
  </div>

  ${orders.length ? `
  <table class="table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Buyer</th>
        <th>Email</th>
        <th>Total</th>
        <th>Status</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      ${orders.map(o => `
      <tr>
        <td>${new Date(o.createdAt).toLocaleString()}</td>
        <td>${o.buyer?.name || "-"}</td>
        <td>${o.buyer?.email || "-"}</td>
        <td>Rs ${o.total}</td>
        <td>
          <span style="
                  padding:4px 8px; border-radius:4px; font-size:0.85rem;
                  background: ${o.status==='placed'?'#e3f2fd': o.status==='processing'?'#fff3e0':'#e8f5e9'};
                  color: ${o.status==='placed'?'#1976d2': o.status==='processing'?'#ef6c00':'#2e7d32'};
                ">
            ${o.status}
          </span>
          ${o.nextStatus ? `
          <form method="POST" action="/admin/order/${o._id}/status" style="display:inline-block; margin-left:10px;">
            <input type="hidden" name="status" value="${o.nextStatus}" />
            <button class="ck-btn" style="padding: 2px 8px; font-size: 0.8rem;">Mark ${o.nextStatus}</button>
          </form>
          ` : ""}
        </td>
        <td><a class="link" href="/admin/orders/${o._id}">View</a></td>
      </tr>
      `).join("")}
    </tbody>
  </table>
  ` : `<p class="muted">No orders yet.</p>`}
  </div>
  `
  }) %>